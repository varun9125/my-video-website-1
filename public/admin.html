<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Admin Panel | KamaBaba Viral</title>
<meta name="robots" content="noindex,nofollow">

<style>
body{
 margin:0;
 background:#0b0b0b;
 color:#fff;
 font-family:system-ui;
}
.wrapper{
 min-height:100vh;
 display:flex;
 align-items:center;
 justify-content:center;
 padding:20px;
}
.panel{
 width:100%;
 max-width:460px;
 background:#141414;
 padding:24px;
 border-radius:16px;
 box-shadow:0 0 30px rgba(255,0,85,.25);
}
h2{text-align:center;margin:0 0 10px;color:#ff0055}
label{display:block;margin-top:14px;font-size:13px;color:#bbb}
input{
 width:100%;
 padding:12px;
 margin-top:6px;
 border-radius:10px;
 border:1px solid #222;
 background:#0f0f0f;
 color:#fff;
}
button{
 width:100%;
 margin-top:18px;
 padding:14px;
 border:none;
 border-radius:12px;
 background:#ff0055;
 color:#fff;
 font-weight:600;
 cursor:pointer;
}
button:disabled{opacity:.6;cursor:not-allowed}
.progress{
 display:none;
 height:8px;
 background:#222;
 margin-top:14px;
 border-radius:10px;
 overflow:hidden;
}
.progress div{
 height:100%;
 width:0%;
 background:#ff0055;
 transition:width .2s;
}
#status{
 margin-top:12px;
 font-size:14px;
 text-align:center;
 min-height:20px;
}
.ok{color:#0f9d58}
.err{color:#ff4444}
</style>
</head>

<body>
<div class="wrapper">
<div class="panel">

<h2>üöÄ Direct Video Upload</h2>

<label>Admin Password</label>
<input id="password" type="password" placeholder="Admin password">

<label>Video Title</label>
<input id="title" type="text" placeholder="SEO friendly title">

<label>Select Video</label>
<input id="video" type="file" accept="video/*">

<div class="progress" id="progress"><div id="bar"></div></div>

<button id="btn">Upload Video</button>
<div id="status"></div>

</div>
</div>

<script>
/* ================= CONFIG (CHANGE THESE) ================= */

// üî¥ CHANGE 1: apna Cloudinary cloud name
const CLOUD_NAME = "YOUR_CLOUD_NAME";

// üî¥ CHANGE 2: unsigned upload preset name
const UPLOAD_PRESET = "YOUR_UNSIGNED_PRESET";

// üî¥ server API (sirf URL save karega)
const SAVE_API = "/api/save-video";

/* ========================================================= */

const btn = document.getElementById("btn");
const status = document.getElementById("status");
const bar = document.getElementById("bar");
const progress = document.getElementById("progress");

btn.onclick = async () => {
 const password = document.getElementById("password").value.trim();
 const title = document.getElementById("title").value.trim();
 const file = document.getElementById("video").files[0];

 if(!password){ status.innerHTML="<span class='err'>Password required</span>"; return; }
 if(!file){ status.innerHTML="<span class='err'>Select a video</span>"; return; }

 btn.disabled = true;
 progress.style.display = "block";
 bar.style.width = "3%";
 status.innerText = "Uploading to Cloudinary‚Ä¶";

 try{
  /* ===== 1Ô∏è‚É£ UPLOAD DIRECT TO CLOUDINARY ===== */
  const fd = new FormData();
  fd.append("file", file);
  fd.append("upload_preset", UPLOAD_PRESET);
  fd.append("folder", "kamababa/videos");

  const xhr = new XMLHttpRequest();
  xhr.open("POST", `https://api.cloudinary.com/v1_1/${CLOUD_NAME}/video/upload`);

  xhr.upload.onprogress = e => {
   if(e.lengthComputable){
    bar.style.width = Math.round((e.loaded / e.total) * 80) + "%";
   }
  };

  xhr.onload = async () => {
   if(xhr.status !== 200){
    throw new Error("Cloudinary upload failed");
   }

   const data = JSON.parse(xhr.responseText);
   bar.style.width = "85%";
   status.innerText = "Saving to server‚Ä¶";

   /* ===== 2Ô∏è‚É£ SAVE URL TO SERVER ===== */
   const res = await fetch(SAVE_API,{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body: JSON.stringify({
     password,
     title: title || "Untitled",
     url: data.secure_url
    })
   });

   const out = await res.json();

   if(out.success){
    bar.style.width = "100%";
    status.innerHTML="<span class='ok'>‚úÖ Upload successful</span>";
    document.getElementById("password").value="";
    document.getElementById("title").value="";
    document.getElementById("video").value="";
   }else{
    throw new Error(out.error || "Save failed");
   }

   btn.disabled = false;
  };

  xhr.onerror = ()=>{ throw new Error("Network error"); };
  xhr.send(fd);

 }catch(err){
  btn.disabled = false;
  status.innerHTML="<span class='err'>‚ùå "+err.message+"</span>";
 }
};
</script>

</body>
</html>
