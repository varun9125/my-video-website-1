<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KamaBaba Viral Videos ðŸ”¥</title>

<style>
body{margin:0;background:#0b0b0b;color:#fff;font-family:system-ui}
header{background:#111;padding:12px;position:sticky;top:0}
header h1{margin:0;text-align:center;font-size:18px}
#search{width:100%;margin-top:10px;padding:10px;border-radius:6px;border:none}

.grid{
 display:grid;
 grid-template-columns:repeat(auto-fill,minmax(180px,1fr));
 gap:12px;
 padding:12px;
}

.thumb{
 aspect-ratio:16/9;
 background:#000;
 border-radius:8px;
 overflow:hidden;
}

.thumb video{
 width:100%;
 height:100%;
 object-fit:cover;
}

.card p{
 font-size:13px;
 white-space:nowrap;
 overflow:hidden;
 text-overflow:ellipsis;
 margin:6px 0 0;
}

.pagination{text-align:center;padding:15px}
.pagination button{
 margin:4px;
 padding:6px 12px;
 border:none;
 border-radius:6px;
 background:#222;
 color:#fff;
}
.pagination .active{background:#ff004f}
</style>
</head>

<body>

<header>
<h1>ðŸ”¥ KamaBaba Viral Videos ðŸ”¥</h1>
<input id="search" placeholder="Search video...">
</header>

<div class="grid" id="grid"></div>

<!-- ðŸ”¥ ADSTERRA NATIVE BANNER -->
<div style="padding:12px">
<script async data-cfasync="false"
src="https://pl28304315.effectivegatecpm.com/75174a0c15fdc41fe820fb9dadf17605/invoke.js"></script>
<div id="container-75174a0c15fdc41fe820fb9dadf17605"></div>
</div>

<div class="pagination" id="pagination"></div>

<script>
/* ===== VIDEO LOGIC ===== */
let allVideos=[], perPage=10;
let page=Number(localStorage.getItem("page"))||1;
let key="";

fetch("/api/videos")
.then(r=>r.json())
.then(d=>{ allVideos=d.reverse(); draw(); });

function draw(){
 grid.innerHTML=""; pagination.innerHTML="";
 const list=allVideos.filter(v=>v.title.toLowerCase().includes(key));
 const total=Math.ceil(list.length/perPage);
 if(page>total) page=1;

 list.slice((page-1)*perPage,page*perPage).forEach(v=>{
  const c=document.createElement("div");
  c.className="card";
  c.innerHTML=`
   <div class="thumb"><video src="${v.url}#t=1" muted preload="metadata"></video></div>
   <p>${v.title}</p>`;
  c.onclick=()=>location.href="/watch?id="+v._id;
  grid.appendChild(c);
 });

 for(let i=1;i<=total;i++){
  const b=document.createElement("button");
  b.innerText=i;
  if(i===page) b.classList.add("active");
  b.onclick=()=>{ page=i; localStorage.setItem("page",i); draw(); scrollTo(0,0); };
  pagination.appendChild(b);
 }
}

search.oninput=e=>{
 key=e.target.value.toLowerCase();
 page=1; localStorage.setItem("page",1);
 draw();
};

/* ===== ADSTERRA DIRECT LINK ===== */
const adLink="https://www.effectivegatecpm.com/t08q3aadri?key=17e7075568b797a5f86e95c5711c322a";
let adOpened=false;

document.addEventListener("click",()=>{
 if(!adOpened){
  window.open(adLink,"_blank");
  adOpened=true;
 }
});
</script>

</body>
</html>
