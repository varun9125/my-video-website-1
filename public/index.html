<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>KamaBaba Viral Videos</title>
<meta name="description" content="Trending adult short videos. 18+ only">

<style>
body{
  margin:0;
  background:#0d0d0d;
  color:#fff;
  font-family:system-ui;
}

header{
  background:#111;
  padding:10px;
  position:sticky;
  top:0;
  z-index:10;
}

header h1{
  text-align:center;
  font-size:18px;
  margin:5px 0;
}

.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(280px,1fr));
  gap:14px;
  padding:12px;
}

.card{
  background:#111;
  border-radius:10px;
  overflow:hidden;
  cursor:pointer;
}

.thumb{
  width:100%;
  aspect-ratio:16/9;
  object-fit:cover;
  background:#000;
}

.card p{
  padding:8px;
  font-size:14px;
  text-align:center;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

.pagination{
  text-align:center;
  padding:15px;
}

.pagination button{
  margin:4px;
  padding:6px 12px;
  border:none;
  background:#222;
  color:#fff;
  border-radius:5px;
  cursor:pointer;
}

.pagination button.active{
  background:#ff0055;
}
</style>
</head>

<body>

<header>
  <h1>ðŸ”¥ KamaBaba Viral Videos ðŸ”¥</h1>
</header>

<main class="grid" id="grid"></main>
<div class="pagination" id="pagination"></div>

<script>
let allVideos=[];
const perPage=10;

// page number URL se lo (refresh safe)
const params=new URLSearchParams(window.location.search);
let currentPage=parseInt(params.get("page"))||1;

fetch("/api/videos")
.then(r=>r.json())
.then(data=>{
  allVideos=data.reverse();
  render();
});

function render(){
  const grid=document.getElementById("grid");
  const pagination=document.getElementById("pagination");
  grid.innerHTML="";
  pagination.innerHTML="";

  const totalPages=Math.ceil(allVideos.length/perPage);
  const start=(currentPage-1)*perPage;
  const pageVideos=allVideos.slice(start,start+perPage);

  pageVideos.forEach(v=>{
    const card=document.createElement("div");
    card.className="card";

    card.innerHTML=`
      <video class="thumb"
        src="${v.url}#t=1"
        muted
        preload="metadata">
      </video>
      <p>${v.title}</p>
    `;

    card.onclick=()=>location.href="/watch.html?id="+v._id;
    grid.appendChild(card);
  });

  for(let i=1;i<=totalPages;i++){
    const btn=document.createElement("button");
    btn.innerText=i;
    if(i===currentPage)btn.classList.add("active");
    btn.onclick=()=>{
      currentPage=i;
      history.pushState(null,"","?page="+i);
      render();
      scrollTo(0,0);
    };
    pagination.appendChild(btn);
  }
}
</script>

</body>
</html>
  const filtered=allVideos.filter(v =>
    v.title.toLowerCase().includes(keyword)
  );

  const totalPages=Math.ceil(filtered.length/perPage);
  const start=(currentPage-1)*perPage;
  const pageVideos=filtered.slice(start,start+perPage);

  pageVideos.forEach(v=>{
    const card=document.createElement("div");
    card.className="card";

    card.innerHTML=`
      <div class="video-box">
        <video 
          src="${v.url}#t=1"
          muted
          preload="metadata"
          playsinline>
        </video>
      </div>
      <p>${v.title}</p>
    `;

    card.onclick=()=>location.href="/watch?id="+v._id;
    grid.appendChild(card);
  });

  /* PAGINATION BUTTONS */
  for(let i=1;i<=totalPages;i++){
    const btn=document.createElement("button");
    btn.innerText=i;
    if(i===currentPage) btn.classList.add("active");
    btn.onclick=()=>{
      currentPage=i;
      render();
      scrollTo(0,0);
    };
    pagination.appendChild(btn);
  }
}

/* SEARCH */
document.getElementById("search").oninput=e=>{
  keyword=e.target.value.toLowerCase();
  currentPage=1;
  render();
};
</script>

</body>
</html>

