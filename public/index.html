<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />

<title>KamaBaba Viral Videos üî• | Adult Desi Viral Clips</title>
<meta name="description" content="Watch trending desi viral adult videos on KamaBaba Viral." />
<meta name="robots" content="index, follow" />
<link rel="icon" href="/favicon.ico" />
<meta name="theme-color" content="#000000" />

<meta name="eroads_" content="045a4e1e1cf1a7e5e5f062c48d692dbb" />

<style>
:root{
  --bg:#0b0b0b;
  --card:#141414;
  --accent:#ff0055;
  --soft:#888;
}
*{box-sizing:border-box}
body{margin:0;background:var(--bg);color:#fff;font-family:system-ui}

/* AGE GATE */
#ageGate{
 position:fixed;inset:0;background:rgba(0,0,0,.95);
 z-index:9999;display:flex;align-items:center;justify-content:center
}
.ageBox{background:#141414;padding:24px;border-radius:12px;text-align:center}
.ageBtns{display:flex;gap:10px;margin-top:16px}
.ageBtns button{
 flex:1;padding:10px;border:none;border-radius:8px;
 font-weight:600;cursor:pointer
}
.yes{background:#0f9d58;color:#fff}
.no{background:#333;color:#fff}

/* ===== HEADER / MENU BAR (ONLY ADDITION) ===== */
header{
 position:sticky;top:0;z-index:10;
 background:#111;padding:10px 14px;border-bottom:1px solid #222
}
.topbar{
 display:flex;
 align-items:center;
 justify-content:space-between;
 gap:10px
}
.brand{
 display:flex;
 align-items:center;
 gap:10px;
 font-weight:800;
 font-size:18px;
 letter-spacing:.3px
}
.brand img{height:36px}
.brand span{color:#fff}
.search-icon{
 font-size:20px;
 cursor:pointer;
 color:#fff
}
#search{
 width:100%;
 margin-top:10px;
 padding:12px;
 border-radius:10px;
 border:none;
 background:#1a1a1a;
 color:#fff;
 display:none;
}

/* TAGS */
.tags{
 display:flex;
 gap:8px;
 overflow-x:auto;
 margin-top:10px;
}
.tags button{
 padding:6px 14px;
 border:none;
 border-radius:20px;
 background:#1f1f1f;
 color:#fff;
 font-size:13px;
 cursor:pointer;
 white-space:nowrap
}
.tags button.active{
 background:var(--accent)
}

/* SORT OPTIONS */
.sort{
 display:flex;
 gap:8px;
 margin-top:10px;
}
.sort button{
 padding:6px 14px;
 border:none;
 border-radius:20px;
 background:#1f1f1f;
 color:#fff;
 font-size:13px;
 cursor:pointer;
}
.sort button.active{
 background:var(--accent)
}

/* GRID */
.grid{
 display:grid;
 grid-template-columns:1fr;
 gap:16px;
 padding:14px;
 max-width:720px;
 margin:0 auto;
}
.card{
 background:var(--card);
 border-radius:12px;
 overflow:hidden;
 cursor:pointer;
 transition: transform 0.3s; /* Hover animation */
}
.card:hover{
 transform: scale(1.05);
}

/* THUMB */
.thumb{
 aspect-ratio:16/9;
 background:#000;
 position:relative;
 overflow:hidden;
}
.thumb img{
 width:100%;
 height:100%;
 object-fit:cover;
 display:block;
}

/* DURATION */
.duration{
 position:absolute;
 right:8px;
 bottom:8px;
 background:rgba(0,0,0,.75);
 padding:3px 6px;
 font-size:11px;
 border-radius:4px;
 color:#fff;
}

/* HOT BADGE */
.hot-badge{
 position:absolute;
 top:8px;
 left:8px;
 background:#ff0055;
 color:#fff;
 padding:2px 6px;
 font-size:10px;
 border-radius:4px;
}

/* INFO */
.info{padding:10px}
.title{
 font-size:14px;
 line-height:1.35;
 font-weight:600;
 white-space:normal;
}
.views{font-size:12px;color:var(--soft)}

/* PAGINATION (REMOVED FOR INFINITE SCROLL) */

/* LOADER */
#loader{text-align:center;padding:20px;color:#888}
</style>
</head>

<body>

<div id="ageGate">
 <div class="ageBox">
  <h2>üîû Adult Content</h2>
  <p>18+ Only</p>
  <div class="ageBtns">
   <button class="yes" onclick="allow()">I am 18+</button>
   <button class="no" onclick="deny()">No</button>
  </div>
 </div>
</div>

<header>
 <div class="topbar">
  <div class="brand">
   <img src="/logo.png" alt="logo">
   <span>KamaBaba Viral</span>
  </div>
  <div class="search-icon" onclick="toggleSearch()">üîç</div>
 </div>

 <input id="search" placeholder="Search hot videos...">

 <div class="tags">
  <button class="active" onclick="setTag('')">All</button>
  <button onclick="setTag('hot')">üî• Hot</button>
  <button onclick="setTag('desi')">üáÆüá≥ Desi</button>
  <button onclick="setTag('viral')">üöÄ Viral</button>
  <button onclick="setTag('new')">üÜï New</button>
  <button onclick="setTag('hd')">HD</button>
  <button onclick="setTag('amateur')">üë© Amateur</button>
 </div>

 <div class="sort">
  <button class="active" onclick="setSort('createdAt')">Latest</button>
  <button onclick="setSort('views')">Most Viewed</button>
  <button onclick="setSort('likes')">Most Liked</button>
 </div>
</header>

<div class="grid" id="grid"></div>

<div id="loader">Loading more videos...</div>

<!-- ADSTERRA (UNCHANGED) -->
<div style="padding:14px;max-width:720px;margin:0 auto">
<script async data-cfasync="false"
 src="https://pl28304315.effectivegatecpm.com/75174a0c15fdc41fe820fb9dadf17605/invoke.js"></script>
<div id="container-75174a0c15fdc41fe820fb9dadf17605"></div>
</div>

<script>
/* AGE GATE */
const ageGate=document.getElementById("ageGate");
if(localStorage.adult==="yes") ageGate.style.display="none";
function allow(){localStorage.adult="yes";ageGate.style.display="none";}
function deny(){location.href="https://google.com";}

const grid=document.getElementById("grid");
const loader=document.getElementById("loader");
const searchInput=document.getElementById("search");

let allVideos=[];
let page=1;
let tag="";
let sortBy="createdAt";
const perPage=8;

function toggleSearch(){
 searchInput.style.display =
  searchInput.style.display==="block"?"none":"block";
 searchInput.focus();
}

function setTag(t){
 tag=t;
 page=1;
 document.querySelectorAll(".tags button").forEach(b=>b.classList.remove("active"));
 event.target.classList.add("active");
 draw();
}

function setSort(s){
 sortBy=s;
 page=1;
 document.querySelectorAll(".sort button").forEach(b=>b.classList.remove("active"));
 event.target.classList.add("active");
 draw();
}

/* CLOUDINARY AUTO THUMB */
function autoThumb(url){
 if(!url || !url.includes("/video/upload/")) return "/logo.png";
 return url.replace("/video/upload/","/video/upload/so_2/")
           .replace(/\.(mp4|mov|webm).*/i,".jpg");
}

/* LOAD */
fetch("/api/videos")
.then(r=>r.json())
.then(vs=>{
 allVideos=Array.isArray(vs)?vs:[];
 draw();
});

function draw(){
 const q=searchInput.value.toLowerCase();
 grid.innerHTML="";

 let list=allVideos.filter(v=>{
  const t=v.title.toLowerCase();
  // Fuzzy search: partial matches
  return (!q || t.includes(q) || q.split(' ').some(word => t.includes(word))) &&
         (!tag || t.includes(tag));
 });

 // Sorting
 list.sort((a, b) => {
  if (sortBy === "views") return b.views - a.views;
  if (sortBy === "likes") return b.likes - a.likes;
  return new Date(b.createdAt) - new Date(a.createdAt);
 });

 const start = (page - 1) * perPage;
 const end = start + perPage;
 const currentList = list.slice(start, end);

 currentList.forEach(v=>{
  const thumb=v.thumbnail||autoThumb(v.url);
  grid.insertAdjacentHTML("beforeend",`
   <div class="card" onclick="location.href='/watch?id=${v._id}'">
    <div class="thumb">
     <img src="${thumb}" loading="lazy">
     <div class="duration" data-url="${v.url}">--:--</div>
     ${v.views > 1000 ? '<div class="hot-badge">üî• Hot</div>' : ''}
    </div>
    <div class="info">
     <div class="title">${v.title}</div>
     <div class="views">üëÅ ${v.views||0} üëç ${v.likes||0}</div>
    </div>
   </div>
  `);
 });

 // Infinite scroll: hide loader if no more
 if (end >= list.length) {
  loader.style.display = "none";
 } else {
  loader.style.display = "block";
 }
}

searchInput.oninput=()=>{page=1;draw();};

// Infinite scroll
let loading = false;
window.addEventListener("scroll", () => {
 if (window.innerHeight + window.scrollY >= document.body.offsetHeight - 100 && !loading) {
  loading = true;
  page++;
  draw();
  loading = false;
 }
});

/* DURATION */
function fmt(sec){
 const m=Math.floor(sec/60);
 const s=Math.floor(sec%60);
 return
