<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KamaBaba Viral Videos ðŸ”¥</title>

<style>
body{
  margin:0;
  background:#0b0b0b;
  color:#fff;
  font-family:system-ui,Arial;
}

header{
  background:#111;
  padding:12px;
  position:sticky;
  top:0;
  z-index:10;
}

header h1{
  margin:0;
  text-align:center;
  font-size:18px;
}

#search{
  width:100%;
  margin-top:10px;
  padding:10px;
  border-radius:6px;
  border:none;
  font-size:14px;
}

/* GRID */
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(180px,1fr));
  gap:12px;
  padding:12px;
}

.card{ cursor:pointer; }

.thumb-wrap{
  width:100%;
  aspect-ratio:16/9;
  background:#000;
  border-radius:8px;
  overflow:hidden;
}

.thumb-wrap video{
  width:100%;
  height:100%;
  object-fit:cover;
}

.card p{
  font-size:13px;
  margin:6px 0 0;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

/* PAGINATION */
.pagination{
  text-align:center;
  padding:15px;
}

.pagination button{
  margin:4px;
  padding:6px 12px;
  border:none;
  border-radius:6px;
  background:#222;
  color:#fff;
  cursor:pointer;
}

.pagination button.active{
  background:#ff004f;
}
</style>
</head>

<body>

<header>
  <h1>ðŸ”¥ KamaBaba Viral Videos ðŸ”¥</h1>
  <input id="search" placeholder="Search video...">
</header>

<main class="grid" id="grid"></main>

<!-- ðŸ”¥ ADSTERRA NATIVE BANNER (SAFE PLACE) -->
<div style="padding:12px">
<script async data-cfasync="false"
src="https://pl28304315.effectivegatecpm.com/75174a0c15fdc41fe820fb9dadf17605/invoke.js"></script>
<div id="container-75174a0c15fdc41fe820fb9dadf17605"></div>
</div>

<div class="pagination" id="pagination"></div>

<script>
let allVideos=[];
let perPage=10;
let keyword="";
let currentPage=Number(localStorage.getItem("page"))||1;

fetch("/api/videos")
.then(r=>r.json())
.then(d=>{
  allVideos=d.reverse();
  render();
});

function render(){
  const grid=document.getElementById("grid");
  const pagination=document.getElementById("pagination");
  grid.innerHTML="";
  pagination.innerHTML="";

  const filtered=allVideos.filter(v =>
    v.title.toLowerCase().includes(keyword)
  );

  const totalPages=Math.ceil(filtered.length/perPage);
  if(currentPage>totalPages) currentPage=1;

  const start=(currentPage-1)*perPage;
  const pageVideos=filtered.slice(start,start+perPage);

  pageVideos.forEach(v=>{
    const card=document.createElement("div");
    card.className="card";
    card.innerHTML=`
      <div class="thumb-wrap">
        <video src="${v.url}#t=1" muted preload="metadata"></video>
      </div>
      <p>${v.title}</p>
    `;
    card.onclick=()=>{
      location.href="/watch?id="+v._id;
    };
    grid.appendChild(card);
  });

  for(let i=1;i<=totalPages;i++){
    const btn=document.createElement("button");
    btn.innerText=i;
    if(i===currentPage) btn.classList.add("active");
    btn.onclick=()=>{
      currentPage=i;
      localStorage.setItem("page",i);
      render();
      scrollTo(0,0);
    };
    pagination.appendChild(btn);
  }
}

document.getElementById("search").oninput=e=>{
  keyword=e.target.value.toLowerCase();
  currentPage=1;
  localStorage.setItem("page",1);
  render();
};
</script>

</body>
</html>
let currentPage = Number(localStorage.getItem("page")) || 1;

/* FETCH VIDEOS */
fetch("/api/videos")
.then(res => res.json())
.then(data => {
  allVideos = data.reverse();
  render();
});

function render(){
  const grid = document.getElementById("grid");
  const pagination = document.getElementById("pagination");

  grid.innerHTML = "";
  pagination.innerHTML = "";

  const filtered = allVideos.filter(v =>
    v.title.toLowerCase().includes(keyword)
  );

  const totalPages = Math.ceil(filtered.length / perPage);
  if(currentPage > totalPages) currentPage = 1;

  const start = (currentPage - 1) * perPage;
  const pageVideos = filtered.slice(start, start + perPage);

  pageVideos.forEach(v => {
    const card = document.createElement("div");
    card.className = "card";
    card.innerHTML = `
      <div class="thumb-wrap">
        <video src="${v.url}#t=1" muted preload="metadata"></video>
      </div>
      <p>${v.title}</p>
    `;
    card.onclick = () => location.href = "/watch?id=" + v._id;
    grid.appendChild(card);
  });

  for(let i = 1; i <= totalPages; i++){
    const btn = document.createElement("button");
    btn.innerText = i;
    if(i === currentPage) btn.classList.add("active");
    btn.onclick = () => {
      currentPage = i;
      localStorage.setItem("page", currentPage);
      render();
      scrollTo(0,0);
    };
    pagination.appendChild(btn);
  }
}

/* SEARCH */
document.getElementById("search").oninput = e => {
  keyword = e.target.value.toLowerCase();
  currentPage = 1;
  localStorage.setItem("page", 1);
  render();
};
</script>

</body>
</html>
let perPage = 10;
let keyword = "";

// PAGE STATE SAVE
let currentPage = Number(localStorage.getItem("page")) || 1;

// FETCH VIDEOS
fetch("/api/videos")
.then(res=>res.json())
.then(data=>{
  allVideos=data.reverse();
  render();
});

function render(){
  const grid=document.getElementById("grid");
  const pagination=document.getElementById("pagination");
  grid.innerHTML="";
  pagination.innerHTML="";

  const filtered=allVideos.filter(v=>
    v.title.toLowerCase().includes(keyword)
  );

  const totalPages=Math.ceil(filtered.length/perPage);
  if(currentPage>totalPages) currentPage=1;

  const start=(currentPage-1)*perPage;
  const pageVideos=filtered.slice(start,start+perPage);

  pageVideos.forEach(v=>{
    const card=document.createElement("div");
    card.className="card";
    card.innerHTML=`
      <div class="thumb-wrap">
        <video src="${v.url}#t=1" muted preload="metadata"></video>
      </div>
      <p>${v.title}</p>
    `;
    card.onclick=()=>{
      location.href="/watch?id="+v._id;
    };
    grid.appendChild(card);
  });

  for(let i=1;i<=totalPages;i++){
    const btn=document.createElement("button");
    btn.innerText=i;
    if(i===currentPage) btn.classList.add("active");
    btn.onclick=()=>{
      currentPage=i;
      localStorage.setItem("page",currentPage);
      render();
      scrollTo(0,0);
    };
    pagination.appendChild(btn);
  }
}

// SEARCH
document.getElementById("search").oninput=e=>{
  keyword=e.target.value.toLowerCase();
  currentPage=1;
  localStorage.setItem("page",1);
  render();
};
</script>

</body>
</html>
  pagination.innerHTML="";

  const totalPages=Math.ceil(allVideos.length/perPage);
  const start=(currentPage-1)*perPage;
  const pageVideos=allVideos.slice(start,start+perPage);

  pageVideos.forEach(v=>{
    const card=document.createElement("div");
    card.className="card";

    card.innerHTML=`
      <video class="thumb"
        src="${v.url}#t=1"
        muted
        preload="metadata">
      </video>
      <p>${v.title}</p>
    `;

    card.onclick=()=>location.href="/watch.html?id="+v._id;
    grid.appendChild(card);
  });

  for(let i=1;i<=totalPages;i++){
    const btn=document.createElement("button");
    btn.innerText=i;
    if(i===currentPage)btn.classList.add("active");
    btn.onclick=()=>{
      currentPage=i;
      history.pushState(null,"","?page="+i);
      render();
      scrollTo(0,0);
    };
    pagination.appendChild(btn);
  }
}
</script>

</body>
</html>
  const filtered=allVideos.filter(v =>
    v.title.toLowerCase().includes(keyword)
  );

  const totalPages=Math.ceil(filtered.length/perPage);
  const start=(currentPage-1)*perPage;
  const pageVideos=filtered.slice(start,start+perPage);

  pageVideos.forEach(v=>{
    const card=document.createElement("div");
    card.className="card";

    card.innerHTML=`
      <div class="video-box">
        <video 
          src="${v.url}#t=1"
          muted
          preload="metadata"
          playsinline>
        </video>
      </div>
      <p>${v.title}</p>
    `;

    card.onclick=()=>location.href="/watch?id="+v._id;
    grid.appendChild(card);
  });

  /* PAGINATION BUTTONS */
  for(let i=1;i<=totalPages;i++){
    const btn=document.createElement("button");
    btn.innerText=i;
    if(i===currentPage) btn.classList.add("active");
    btn.onclick=()=>{
      currentPage=i;
      render();
      scrollTo(0,0);
    };
    pagination.appendChild(btn);
  }
}

/* SEARCH */
document.getElementById("search").oninput=e=>{
  keyword=e.target.value.toLowerCase();
  currentPage=1;
  render();
};
</script>

</body>
</html>

