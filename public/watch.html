<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Watch Video | KamaBaba Viral</title>

<link rel="icon" href="/favicon.ico">
<link rel="apple-touch-icon" href="/logo-192.png">
<meta name="theme-color" content="#000000">

<style>
body{margin:0;background:#000;color:#fff;font-family:system-ui}
#player{width:100%;max-height:60vh}
.info{padding:12px}
.meta{font-size:13px;color:#aaa}
.actions{display:flex;gap:10px;margin-top:10px}
.actions button{padding:8px 14px;border:none;border-radius:8px;background:#1c1c1c;color:#fff}
#related{display:grid;grid-template-columns:repeat(auto-fill,minmax(160px,1fr));gap:12px;padding:12px}
.card{background:#111;border-radius:8px;overflow:hidden;cursor:pointer}
.card video{width:100%;aspect-ratio:16/9;object-fit:cover}
.card p{font-size:13px;margin:6px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
</style>
</head>

<body>

<div style="text-align:center;padding:8px">
 <img src="/logo.png" style="height:36px">
</div>

<video id="player" controls playsinline></video>

<div class="info">
 <h3 id="title">Loading...</h3>
 <div class="meta">ğŸ‘ <span id="views">0</span> ğŸ‘ <span id="likes">0</span></div>
 <div class="actions">
  <button onclick="like()">ğŸ‘ Like</button>
  <button onclick="share()">ğŸ”— Share</button>
 </div>
</div>

<!-- ADSTERRA -->
<div style="padding:12px">
<script async data-cfasync="false"
src="https://pl28304315.effectivegatecpm.com/75174a0c15fdc41fe820fb9dadf17605/invoke.js"></script>
<div id="container-75174a0c15fdc41fe820fb9dadf17605"></div>
</div>

<h3 style="padding-left:12px">Related</h3>
<div id="related"></div>

<script>
const id=new URLSearchParams(location.search).get("id");
fetch("/api/videos").then(r=>r.json()).then(vs=>{
 const v=vs.find(x=>x._id===id);
 if(!v)return;
 player.src=v.url;
 title.innerText=v.title;
 views.innerText=v.views||0;
 likes.innerText=v.likes||0;

 vs.filter(x=>x._id!==id).slice(0,8).forEach(r=>{
  related.innerHTML+=`
  <div class="card" onclick="location.href='/watch?id=${r._id}'">
   <video src="${r.url}#t=1" muted preload="metadata"></video>
   <p>${r.title}</p>
  </div>`;
 });
});

function like(){fetch("/api/like/"+id,{method:"POST"});likes.innerText++}
function share(){navigator.clipboard.writeText(location.href);alert("Link copied")}

/* SMARTLINK */
let o=false;
document.addEventListener("click",()=>{
 if(!o){
  window.open("https://www.effectivegatecpm.com/t08q3aadri?key=17e7075568b797a5f86e95c5711c322a","_blank");
  o=true;
 }
});
</script>

</body>
</html>
