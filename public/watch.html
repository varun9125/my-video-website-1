<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Watch Video | KamaBaba</title>
<meta name="robots" content="index, follow">
<meta name="rating" content="adult">

<style>
body{
  margin:0;
  background:#0b0b0b;
  color:#fff;
  font-family:system-ui
}
header{
  padding:10px;
  background:#111;
  text-align:center;
  font-weight:700;
  font-size:18px
}
.container{
  max-width:900px;
  margin:auto;
  padding:10px
}
video{
  width:100%;
  border-radius:12px;
  background:#000
}
.title{
  font-size:16px;
  margin:10px 0;
  font-weight:600
}

/* ACTIONS */
.actions{
  display:flex;
  gap:10px;
  margin:10px 0
}
.actions button{
  flex:1;
  padding:10px;
  background:#222;
  color:#fff;
  border:none;
  border-radius:6px;
  cursor:pointer
}
.actions button:hover{background:#ff0055}

/* RELATED */
.related-title{
  margin:20px 0 10px;
  font-size:17px;
  font-weight:700
}
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(150px,1fr));
  gap:12px
}
.card{
  cursor:pointer
}
.thumb{
  width:100%;
  height:180px;
  object-fit:cover;
  border-radius:8px;
  background:#000
}
.card p{
  font-size:13px;
  margin:5px 0 0;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
  text-align:center
}
.adbox{
  margin:15px 0;
  text-align:center
}
</style>
</head>

<body>

<header>ğŸ”¥ KamaBaba ğŸ”¥</header>

<div class="container">

  <!-- ================= VIDEO PLAYER ================= -->
  <video id="player" controls autoplay playsinline></video>
  <div class="title" id="title">Loading...</div>

  <div class="actions">
    <button onclick="like()">ğŸ‘ Like</button>
    <button onclick="dislike()">ğŸ‘ Dislike</button>
    <button onclick="share()">ğŸ”— Share</button>
  </div>

  <!-- ================= ADSTERRA NATIVE (TOP) ================= -->
  <div class="adbox">
    <!-- ğŸ”½ ADSTERRA NATIVE / BANNER CODE HERE ğŸ”½ -->
    <!-- ADSTERRA_CODE_HERE -->
  </div>

  <!-- ================= RELATED VIDEOS ================= -->
  <div class="related-title">ğŸ”¥ Related Videos</div>
  <div class="grid" id="related"></div>

</div>

<!-- ================= ADSTERRA POPUNDER ================= -->
<!-- ğŸ”½ ADSTERRA POPUNDER CODE HERE ğŸ”½ -->
<!-- ADSTERRA_CODE_HERE -->
<!-- ================= END AD ================= -->

<script>
const params = new URLSearchParams(location.search);
const id = params.get("id");

let allVideos = [];
let currentVideo = null;

fetch("/api/videos")
.then(r=>r.json())
.then(videos=>{
  allVideos = videos;
  currentVideo = videos.find(v=>v._id===id);

  if(!currentVideo){
    alert("Video not found");
    return;
  }

  document.getElementById("player").src = currentVideo.url;
  document.getElementById("title").innerText = currentVideo.title;

  fetch("/api/view/"+id,{method:"POST"});

  renderRelated();
});

function renderRelated(){
  const box = document.getElementById("related");
  box.innerHTML="";

  allVideos
  .filter(v=>v._id!==id)
  .slice(0,8)
  .forEach(v=>{
    const d=document.createElement("div");
    d.className="card";
    d.innerHTML=`
      <video class="thumb" src="${v.url}#t=1" muted preload="metadata"></video>
      <p>${v.title}</p>
    `;
    d.onclick=()=>location.href="/watch?id="+v._id;
    box.appendChild(d);
  });
}

/* ACTIONS */
function like(){
  fetch("/api/like/"+id,{method:"POST"});
  alert("ğŸ‘ Liked");
}
function dislike(){
  fetch("/api/dislike/"+id,{method:"POST"});
  alert("ğŸ‘ Disliked");
}
function share(){
  navigator.clipboard.writeText(location.href);
  alert("ğŸ”— Link copied");
}
</script>

</body>
</html>
